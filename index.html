<!DOCTYPE html>
<html lang="en">    
<head>    
  <meta charset="UTF-8" />    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />    
  <title>Spiritual Shadow - Lobby</title>    
  <script src="https://telegram.org/js/telegram-web-app.js"></script>    
  <script>    
    const adScript = document.createElement('script');    
    adScript.src = 'https://libtl.com/sdk.js';    
    adScript.setAttribute('data-zone', '9494630');    
    adScript.setAttribute('data-sdk', 'show_9494630');    
    document.head.appendChild(adScript);

    window.showAdThenPlay = function () {    
      if (typeof show_9494630 === 'function') {    
        show_9494630()
          .then(() => { window.location.href = 'game.html'; })    
          .catch(() => { window.location.href = 'game.html'; });    
      } else {    
        setTimeout(() => window.location.href = 'game.html', 3000);    
      }    
    }    
  </script>    

  <script type="module">    
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";    
    import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";    
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {    
      apiKey: "AIzaSyAXgSGleDzngVCD2R-LzJfzACPoYx6xnpk",    
      authDomain: "spiritual-shadow.firebaseapp.com",    
      projectId: "spiritual-shadow"    
    };    
    
    const app = initializeApp(firebaseConfig);    
    const auth = getAuth(app);    
    const db = getFirestore(app);    
    const tg = window.Telegram.WebApp;    
    tg.ready();    
    
    const infoBox = document.getElementById("playerInfo");    
    
    signInAnonymously(auth).then(() => {    
      onAuthStateChanged(auth, async user => {    
        if (!user) return;    
        const uid = user.uid;    
        const ref = doc(db, "users", uid);    
        let snap = await getDoc(ref);    
        if (!snap.exists()) {    
          await setDoc(ref, {    
            uid,    
            name: tg.initDataUnsafe.user?.first_name || "Unknown",    
            tg_id: tg.initDataUnsafe.user?.id || "N/A",    
            created_at: Date.now(),    
            shadow_coin_weekly: 0,    
            shadow_coin_total: 0,    
            available_shadow_coin: 0,    
            total_valid_refer: 0,    
            usd_balance: 0    
          });    
          snap = await getDoc(ref);    
        }    
        const data = snap.data();    
        infoBox.innerHTML = `    
          üë§ ${data.name}<br>    
          üÜî ${tg.id}<br>  
          <p>weekly Shadow Coin: ${shadow_coin_weekly}</p>,
          <p>Total Vaild Refer: ${total_vaild_refer}</p>,
          üí∞ ${data.available_shadow_coin} Shadow Coins<br>    
          üíµ Balance: $${data.usd_balance.toFixed(2)}    
        `;    
      });    
    });    
  </script>    
  

  <style>   <body>
  <!-- üé∂ Background Music -->
  <audio id="bgMusic" autoplay loop>
    <source src="https://media.vocaroo.com/mp3/1mZoJhLE71L9" type="audio/mpeg">
  </audio> 
    body {    
      margin: 0;    
      font-family: 'Segoe UI', sans-serif;    
      background: linear-gradient(#0a0a0a, #1a1a2e);    
      color: #f0f0f0;    
      display: flex;    
      flex-direction: column;    
      align-items: center;    
      padding: 20px;    
      position: relative;
      overflow-x: hidden;
      min-height: 100vh;
    }    

    /* FOG CONTAINER */
    #parallax-fog {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }
    .fog-layer {
      position: absolute;
      width: 200%;
      height: 100%;
      background-repeat: repeat;
      background-size: cover;
      opacity: 0.18;
      filter: blur(4px) brightness(1.2);
      mix-blend-mode: screen;
    }
    .fog1 {
      background-image: url('https://i.ibb.co/wrWxpyP/fog-layer1.png');
      animation: moveFog1 30s linear infinite;
    }
    .fog2 {
      background-image: url('https://i.ibb.co/vz5BtPt/fog-layer2.png');
      animation: moveFog2 30s linear infinite;
      opacity: 0.1;
    }
    @keyframes moveFog1 {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    @keyframes moveFog2 {
      0% { transform: translateX(0); }
      100% { transform: translateX(-80%); }
    }

    .logo {    
      font-size: 2em;    
      font-weight: bold;    
      margin: 20px 0;    
      color: #5f27cd;    
      z-index: 1;
      position: relative;
    }    
    #playerInfo {    
      background: rgba(255, 255, 255, 0.05);    
      border-radius: 12px;    
      padding: 15px;    
      width: 100%;    
      max-width: 400px;    
      font-size: 14px;    
      margin-bottom: 20px;
      z-index: 1;
      position: relative;
      box-shadow: 0 0 10px rgba(95, 39, 205, 0.4);
    }    
    .menu {    
      display: flex;    
      flex-direction: column;    
      gap: 10px;    
      margin: 20px 0;    
      width: 100%;    
      max-width: 300px;
      z-index: 1;
      position: relative;
    }    
    .menu button {    
      background: #5f27cd;    
      border: none;    
      padding: 15px;    
      border-radius: 10px;    
      color: white;    
      font-size: 16px;    
      cursor: pointer;    
    }    
    .bottom-nav {    
      display: flex;    
      justify-content: space-around;    
      width: 100%;    
      max-width: 400px;    
      margin-top: auto;    
      padding: 10px 0;
      z-index: 1;
      position: relative;
    }    
    .bottom-nav button {    
      background: transparent;    
      color: #f0f0f0;    
      border: none;    
      font-size: 14px;    
    }    
    .floating-btns {    
      position: fixed;    
      right: 10px;    
      bottom: 70px;    
      display: flex;    
      flex-direction: column;    
      gap: 10px;
      z-index: 1;
    }    
    .floating-btns button {    
      background: #222;    
      color: white;    
      border: 1px solid #5f27cd;    
      border-radius: 10px;    
      padding: 10px;    
    }    
  </style>    
</head>    
<body>    

  <!-- Fog Layers -->
  <div id="parallax-fog">
    <div class="fog-layer fog1"></div>
    <div class="fog-layer fog2"></div>
  </div>

  <div class="logo">Spiritual Shadow</div>    
  <div id="playerInfo">Loading player data...</div>    
  <div class="menu">    
    <button onclick="showAdThenPlay()">‚ñ∂ Play Now</button>    
    <button onclick="openwindow.customize_shadow()"üßô Customize Shadow</button>    
    <button>üéÆ Game Modes</button>    
  </div>    
  <div class="floating-btns">    
    <button>üèÜ Leaderboard</button>    
    <button>üéÅ Daily Rewards</button>    
    <button>üíå Notifications</button>    
  </div>    
  <div class="bottom-nav">    
    <button>üìú Missions</button>    
    <button>‚õè Offline Mining</button>    
    <button>üõí Shop</button>    
    <button>‚öô Settings</button>    
  </div>    

</body>    
</html>
